К сожалению, консоль Windows имеет очень ограниченную и неподходящую поддержку для UTF-8.

Что можно сделать: установите кодовую страницу в 65001 и используйте один из шрифтов, которые ее поддерживают, например. "Консоль Lucida". Кодовая страница может быть задана командой chcp или, в C/С++, функцией SetConsoleOutputCP; шрифт устанавливается с помощью SetCurrentConsoleFontEx.

Однако существуют некоторые основные (и второстепенные) проблемы. Незначительное сначала:

a) Эти функции действительны для одного сеанса, т.е. если вы снова запустите программу позже, вы должны установить ее снова. По умолчанию это возможно в теории, но не рекомендуется, потому что это повлияет на все консольные программы и представит проблемы ниже, даже если они ничего не делают с кодовыми страницами и не написаны для смягчения проблем.

b) Если консоль не открывается программой, но вы начинаете ее с существующей консоли, она будет влиять на все прогоны после нее, пока эта консоль не будет закрыта. Таким образом, вы должны изменить его на значение по умолчанию до выхода вашей собственной программы.

c) Некоторые функции, используемые для ввода/вывода консоли, не работают должным образом с CP65001.
(это самая суровая вещь)